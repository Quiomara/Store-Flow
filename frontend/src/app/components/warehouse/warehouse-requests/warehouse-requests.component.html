<div class="warehouse-requests-container">
    <h1 class="text-center">Sistema Integrado de Gestión</h1>
    <h2 class="text-center">PRÉSTAMO DE HERRAMIENTAS</h2>

    <!-- Mensaje cuando no hay solicitudes -->
    <div *ngIf="solicitudesVisibles.length === 0" class="no-requests-message text-center">
        <p>No hay solicitudes de préstamos pendientes.</p>
    </div>

    <!-- Tabla de solicitudes -->
    <div *ngIf="solicitudesVisibles.length > 0" class="table-responsive">
        <table class="table mt-5">
            <thead>
                <tr>
                    <th class="id">ID PRÉSTAMO</th>
                    <th class="solicitante">SOLICITANTE</th>
                    <th class="fecha">FECHA Y HORA</th>
                    <th>DETALLES DEL PRÉSTAMO</th>
                    <th>ESTADO</th>
                    <th class="acciones">ACCIONES</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let solicitud of solicitudesVisibles" [ngClass]="{
                    'created': solicitud.estado === 'Creado',
                    'in-process': solicitud.estado === 'En proceso',
                    'in-loan': solicitud.estado === 'En préstamo'
                }">
                    <td class="id">{{ solicitud.idPrestamo }}</td>
                    <td class="solicitante">{{ solicitud.solicitante }}</td>
                    <td class="fecha">{{ solicitud.fechaHora | date:'medium' }}</td>
                    <td>
                        <button class="btn btn-info btn-sm" (click)="verDetalles(solicitud)">
                            <i class="fas fa-eye"></i> Ver
                        </button>
                    </td>
                    <td>
                        <span class="badge" [ngClass]="{
                            'badge-secondary': solicitud.estado === 'Creado',
                            'badge-primary': solicitud.estado === 'En proceso',
                            'badge-warning': solicitud.estado === 'En préstamo',
                            'badge-success': solicitud.estado === 'Entregado',
                            'badge-danger': solicitud.estado === 'Cancelado'
                        }">
                            {{ solicitud.estado }}
                        </span>
                    </td>
                    <td class="acciones">
                        <ng-container *ngIf="solicitud.estado === 'Creado'">
                            <button type="button" class="btn btn-success btn-sm" (click)="aprobarSolicitud(solicitud)">
                                <i class="fas fa-check"></i> Aceptar
                            </button>
                            <button type="button" class="btn btn-danger btn-sm" (click)="rechazarSolicitud(solicitud)">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </ng-container>
                        <ng-container *ngIf="solicitud.estado === 'En proceso'">
                            <button type="button" class="btn btn-primary btn-sm" (click)="marcarComoEnPrestamo(solicitud)">
                                <i class="fas fa-hand-holding"></i> En Préstamo
                            </button>
                        </ng-container>
                        <ng-container *ngIf="solicitud.estado === 'En préstamo'">
                            <button type="button" class="btn btn-success btn-sm" (click)="marcarComoEntregado(solicitud)">
                                <i class="fas fa-check-double"></i> Entregar
                            </button>
                        </ng-container>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>